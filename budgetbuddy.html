<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Budget Buddy Products</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #ff3366;
            --primary-dark: #e62e5e;
            --secondary: #7c5cff;
            --dark: #0f172a;
            --light: #f8f9fa;
            --gray: #6c757d;
            --success: #28a745;
            --warning: #ffc107;
            --border-radius: 12px;
            --shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s ease;
            
            --bg-color: #0f172a;
            --text-color: #e2e8f0;
            --card-bg: #1e293b;
            --header-bg: linear-gradient(135deg, var(--primary), var(--secondary));
            --footer-bg: var(--dark);
            --image-border: #334155;
        }

        [data-theme="light"] {
            --bg-color: #f5f7fa;
            --text-color: #333;
            --card-bg: white;
            --header-bg: linear-gradient(135deg, var(--primary), var(--secondary));
            --footer-bg: var(--dark);
            --image-border: #e2e8f0;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            line-height: 1.6;
            transition: var(--transition);
            overflow-x: hidden;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 10px;
        }

        /* Header */
        header {
            background: var(--header-bg);
            color: white;
            padding: 8px 0;
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 8px;
        }

        .logo {
            font-size: 0.9rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            white-space: nowrap;
        }

        .logo i {
            margin-right: 4px;
            font-size: 1rem;
        }

        .header-actions {
            display: flex;
            align-items: center;
            gap: 4px;
            flex-wrap: nowrap;
        }

        .theme-toggle, .language-btn {
            background: rgba(255, 255, 255, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 3px 6px;
            border-radius: 12px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 3px;
            font-size: 0.65rem;
            transition: var(--transition);
            white-space: nowrap;
            min-height: 28px;
        }

        .theme-toggle:hover, .language-btn:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .search-bar {
            display: flex;
            background: white;
            border-radius: 16px;
            overflow: hidden;
            flex: 1;
            min-width: 100px;
            max-width: 140px;
        }

        .search-bar input {
            flex: 1;
            border: none;
            padding: 4px 8px;
            outline: none;
            font-size: 0.7rem;
            color: var(--dark);
            min-width: 0;
        }

        .search-bar button {
            background: var(--primary);
            border: none;
            color: white;
            padding: 0 8px;
            cursor: pointer;
            transition: var(--transition);
            min-width: 30px;
        }

        .search-bar button:hover {
            background: var(--primary-dark);
        }

        /* Language Dropdown */
        .language-selector {
            position: relative;
        }

        .language-dropdown {
            position: absolute;
            top: 100%;
            right: 0;
            background: var(--card-bg);
            color: var(--text-color);
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            min-width: 120px;
            max-height: 200px;
            overflow-y: auto;
            display: none;
            z-index: 1001;
            margin-top: 4px;
        }

        .language-dropdown.show {
            display: block;
        }

        .language-option {
            padding: 6px 10px;
            cursor: pointer;
            border-bottom: 1px solid rgba(108, 117, 125, 0.3);
            transition: var(--transition);
            font-size: 0.7rem;
        }

        .language-option:hover {
            background: var(--primary);
            color: white;
        }

        /* Toast */
        .toast {
            position: fixed;
            bottom: 15px;
            left: 50%;
            transform: translateX(-50%) translateY(100px);
            background: var(--success);
            color: white;
            padding: 8px 14px;
            border-radius: 8px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.2);
            z-index: 1002;
            opacity: 0;
            transition: all 0.4s ease;
            display: flex;
            align-items: center;
            gap: 5px;
            font-weight: 600;
            font-size: 0.75rem;
            max-width: 90%;
            text-align: center;
            white-space: nowrap;
        }

        .toast.show {
            opacity: 1;
            transform: translateX(-50%) translateY(0);
        }

        /* Hero */
        .hero {
            background: linear-gradient(rgba(0,0,0,0.7), rgba(0,0,0,0.7)), 
                        url('https://images.unsplash.com/photo-1607082350899-7e105aa886ae?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80');
            background-size: cover;
            background-position: center;
            color: white;
            text-align: center;
            padding: 25px 12px;
            margin-bottom: 12px;
        }

        .hero h1 {
            font-size: 1.1rem;
            margin-bottom: 5px;
        }

        .hero p {
            font-size: 0.75rem;
            max-width: 100%;
            margin: 0 auto;
        }

        /* Status */
        .status-info {
            background: var(--card-bg);
            padding: 8px;
            border-radius: 8px;
            box-shadow: var(--shadow);
            margin-bottom: 10px;
            text-align: center;
            font-size: 0.75rem;
        }

        /* Categories */
        .categories {
            display: flex;
            gap: 4px;
            margin-bottom: 10px;
            flex-wrap: nowrap;
            overflow-x: auto;
            padding-bottom: 5px;
            -webkit-overflow-scrolling: touch;
            max-width: 100%;
        }

        .categories::-webkit-scrollbar {
            height: 2px;
        }

        .categories::-webkit-scrollbar-track {
            background: transparent;
        }

        .categories::-webkit-scrollbar-thumb {
            background: var(--gray);
            border-radius: 2px;
        }

        .category-btn {
            background: var(--card-bg);
            border: 1px solid var(--gray);
            padding: 4px 8px;
            border-radius: 12px;
            cursor: pointer;
            font-size: 0.65rem;
            display: flex;
            align-items: center;
            gap: 3px;
            transition: var(--transition);
            color: var(--text-color);
            white-space: nowrap;
            flex-shrink: 0;
            min-height: 28px;
        }

        .category-btn.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        /* Sort Button */
        .sort-select {
            padding: 4px 8px;
            border-radius: 12px;
            border: 1px solid var(--gray);
            background: var(--card-bg);
            color: var(--text-color);
            font-size: 0.65rem;
            min-width: 100px;
            cursor: pointer;
            transition: var(--transition);
            flex-shrink: 0;
            min-height: 28px;
        }

        .sort-select:hover {
            border-color: var(--secondary);
        }

        /* Favorites Management */
        .favorites-management {
            background: var(--card-bg);
            padding: 8px;
            border-radius: 8px;
            box-shadow: var(--shadow);
            margin-bottom: 10px;
            display: none;
            flex-direction: column;
            align-items: flex-start;
            gap: 6px;
        }

        .favorites-management.show {
            display: flex;
        }

        .clear-favorites-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 600;
            transition: var(--transition);
            font-size: 0.7rem;
            width: 100%;
            min-height: 32px;
        }

        .clear-favorites-btn:hover {
            background: var(--primary-dark);
        }

        #favorites-count {
            font-size: 0.75rem;
            font-weight: 600;
            width: 100%;
            text-align: center;
        }

        /* Confirmation Modal */
        .confirmation-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            padding: 12px;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .confirmation-modal.show {
            opacity: 1;
            visibility: visible;
        }

        .confirmation-content {
            background: var(--card-bg);
            border-radius: 10px;
            box-shadow: var(--shadow);
            width: 100%;
            max-width: 320px;
            overflow: hidden;
            transform: translateY(20px);
            transition: transform 0.3s ease;
        }

        .confirmation-modal.show .confirmation-content {
            transform: translateY(0);
        }

        .confirmation-header {
            padding: 10px 12px;
            border-bottom: 1px solid var(--gray);
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: var(--header-bg);
            color: white;
        }

        .confirmation-title {
            font-size: 0.9rem;
            font-weight: 600;
            margin: 0;
        }

        .confirmation-close {
            background: none;
            border: none;
            color: white;
            font-size: 0.9rem;
            cursor: pointer;
            width: 22px;
            height: 22px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: var(--transition);
        }

        .confirmation-close:hover {
            background: rgba(255,255,255,0.2);
        }

        .confirmation-body {
            padding: 12px;
            text-align: center;
        }

        .confirmation-message {
            font-size: 0.8rem;
            margin-bottom: 12px;
            line-height: 1.4;
        }

        .confirmation-actions {
            display: flex;
            gap: 6px;
            justify-content: center;
        }

        .confirm-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 600;
            transition: var(--transition);
            font-size: 0.75rem;
            flex: 1;
            min-height: 32px;
        }

        .confirm-btn:hover {
            background: var(--primary-dark);
        }

        .cancel-btn {
            background: var(--gray);
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 600;
            transition: var(--transition);
            font-size: 0.75rem;
            flex: 1;
            min-height: 32px;
        }

        .cancel-btn:hover {
            background: #5a6268;
        }

        /* Products Grid - MOBİL İÇİN 2 KOLON */
        .products-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 8px;
            padding: 0;
            max-width: 100%;
            margin: 0 auto;
            width: 100%;
        }

        .product-card {
            background: var(--card-bg);
            border-radius: 6px;
            padding: 8px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            box-shadow: var(--shadow);
            transition: transform .2s;
            width: 100%;
            height: auto;
            min-height: 280px;
            overflow: hidden;
        }

        .product-card:hover {
            transform: translateY(-3px);
        }

        .product-image-container {
            position: relative;
            cursor: pointer;
            margin-bottom: 6px;
            width: 100%;
            height: 120px;
            overflow: hidden;
            border-radius: 5px;
        }

        .product-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 5px;
        }

        .product-badge {
            position: absolute;
            top: 4px;
            right: 4px;
            background: var(--primary);
            color: white;
            padding: 2px 4px;
            border-radius: 6px;
            font-size: 0.55rem;
            font-weight: 600;
            z-index: 2;
        }

        .category-badge {
            position: absolute;
            top: 4px;
            left: 4px;
            background: var(--secondary);
            color: white;
            padding: 2px 4px;
            border-radius: 6px;
            font-size: 0.55rem;
            font-weight: 600;
            z-index: 2;
            max-width: 55px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .remove-favorite-btn {
            position: absolute;
            top: 30px;
            right: 4px;
            background: rgba(255,255,255,0.95);
            border: none;
            border-radius: 50%;
            width: 18px;
            height: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
            opacity: 1;
            z-index: 3;
            font-size: 0.55rem;
            color: var(--dark);
        }

        .remove-favorite-btn:hover {
            background: var(--primary);
            color: white;
        }

        .product-info {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            width: 100%;
        }

        .product-title {
            font-weight: 600;
            margin: 4px 0;
            font-size: 0.7rem;
            line-height: 1.2;
            cursor: pointer;
            position: relative;
            overflow: hidden;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            height: 30px;
        }

        .product-title.expanded {
            -webkit-line-clamp: unset;
            height: auto;
        }

        .product-price {
            display: flex;
            align-items: center;
            margin-bottom: 5px;
            gap: 3px;
            flex-wrap: wrap;
        }

        .current-price {
            font-weight: bold;
            font-size: 0.8rem;
            color: var(--primary);
        }

        .original-price {
            font-size: 0.65rem;
            color: var(--gray);
            text-decoration: line-through;
        }

        .discount {
            background: var(--success);
            color: white;
            padding: 1px 3px;
            border-radius: 2px;
            font-size: 0.55rem;
            font-weight: 600;
        }

        .product-code {
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            color: white;
            padding: 4px 6px;
            border-radius: 4px;
            margin-bottom: 6px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.65rem;
            font-weight: 600;
            width: 100%;
        }

        .code-label {
            font-size: 0.6rem;
            white-space: nowrap;
        }

        .code-value {
            cursor: pointer;
            padding: 2px 4px;
            border-radius: 2px;
            background: rgba(255,255,255,0.2);
            font-weight: 600;
            transition: var(--transition);
            font-size: 0.65rem;
            white-space: nowrap;
        }

        .code-value:hover {
            background: rgba(255,255,255,0.3);
        }

        .product-actions {
            display: flex;
            gap: 4px;
            margin-top: 6px;
            width: 100%;
        }

        .buy-btn {
            flex: 2;
            background: var(--primary);
            color: white;
            border: none;
            padding: 5px;
            border-radius: 4px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 2px;
            font-size: 0.65rem;
            font-weight: 600;
            text-decoration: none;
            transition: var(--transition);
            white-space: nowrap;
            min-height: 30px;
        }

        .buy-btn:hover {
            background: var(--primary-dark);
        }

        .wishlist-btn, .share-btn {
            flex: 1;
            background: var(--card-bg);
            border: 1px solid var(--gray);
            border-radius: 4px;
            padding: 5px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
            color: var(--text-color);
            min-width: 30px;
            min-height: 30px;
        }

        .wishlist-btn.active {
            background: #ff4757;
            color: white;
            border-color: #ff4757;
        }

        .wishlist-btn:hover, .share-btn:hover {
            background: var(--secondary);
            color: white;
        }

        /* Loading */
        .loading {
            text-align: center;
            padding: 12px;
            display: none;
            grid-column: 1 / -1;
        }

        .loading-spinner {
            border: 2px solid var(--gray);
            border-top: 2px solid var(--primary);
            border-radius: 50%;
            width: 18px;
            height: 18px;
            animation: spin 1s linear infinite;
            margin: 0 auto 6px;
        }

        .loading p {
            font-size: 0.75rem;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* End of Results */
        .end-of-results {
            text-align: center;
            padding: 15px 8px;
            color: var(--gray);
            display: none;
            grid-column: 1 / -1;
        }

        .end-of-results i {
            font-size: 1.3rem;
            margin-bottom: 6px;
            color: var(--gray);
        }

        .end-of-results h3 {
            font-size: 0.85rem;
            margin-bottom: 4px;
        }

        .end-of-results p {
            font-size: 0.7rem;
        }

        /* No Favorites */
        .no-favorites {
            text-align: center;
            padding: 25px 8px;
            color: var(--gray);
            display: none;
            grid-column: 1 / -1;
        }

        .no-favorites i {
            font-size: 1.8rem;
            margin-bottom: 6px;
            color: var(--gray);
        }

        .no-favorites h3 {
            font-size: 0.85rem;
            margin-bottom: 4px;
        }

        .no-favorites p {
            font-size: 0.7rem;
        }

        /* Footer */
        footer {
            background: var(--footer-bg);
            color: white;
            padding: 15px 0 8px;
            margin-top: 15px;
        }

        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 12px;
            margin-bottom: 10px;
        }

        .footer-section h3 {
            margin-bottom: 6px;
            font-size: 0.85rem;
        }

        .footer-section p, .footer-section ul li a {
            font-size: 0.7rem;
        }

        .footer-section ul {
            list-style: none;
        }

        .footer-section ul li {
            margin-bottom: 3px;
        }

        .footer-section ul li a {
            color: #bbb;
            text-decoration: none;
            transition: var(--transition);
        }

        .footer-section ul li a:hover {
            color: white;
        }

        .copyright {
            text-align: center;
            padding-top: 8px;
            border-top: 1px solid #444;
            color: #bbb;
            font-size: 0.65rem;
        }

        /* Copy Message */
        .copy-msg {
            position: fixed;
            bottom: 12px;
            right: 12px;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            color: white;
            padding: 6px 10px;
            border-radius: 6px;
            font-weight: bold;
            display: none;
            box-shadow: 0 0 12px rgba(124,92,255,0.4);
            z-index: 1003;
            font-size: 0.75rem;
        }

        /* Modal Styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            padding: 12px;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .modal-overlay.show {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background: var(--card-bg);
            border-radius: 10px;
            box-shadow: var(--shadow);
            width: 100%;
            max-width: 350px;
            max-height: 65vh;
            overflow: hidden;
            transform: translateY(20px);
            transition: transform 0.3s ease;
        }

        .modal-overlay.show .modal-content {
            transform: translateY(0);
        }

        .modal-header {
            padding: 10px 12px;
            border-bottom: 1px solid var(--gray);
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: var(--header-bg);
            color: white;
        }

        .modal-title {
            font-size: 0.9rem;
            font-weight: 600;
            margin: 0;
        }

        .modal-close {
            background: none;
            border: none;
            color: white;
            font-size: 0.9rem;
            cursor: pointer;
            width: 22px;
            height: 22px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: var(--transition);
        }

        .modal-close:hover {
            background: rgba(255,255,255,0.2);
        }

        .modal-body {
            padding: 0;
            max-height: 55vh;
            overflow-y: auto;
        }

        .categories-modal-list {
            list-style: none;
            margin: 0;
            padding: 0;
        }

        .category-modal-item {
            padding: 8px 12px;
            border-bottom: 1px solid var(--gray);
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .category-modal-item:last-child {
            border-bottom: none;
        }

        .category-modal-item:hover {
            background: var(--primary);
            color: white;
        }

        .category-modal-item.active {
            background: var(--secondary);
            color: white;
        }

        .category-name {
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 0.8rem;
        }

        .category-count {
            background: var(--gray);
            color: white;
            padding: 1px 5px;
            border-radius: 6px;
            font-size: 0.7rem;
            font-weight: 600;
            min-width: 30px;
            text-align: center;
        }

        .category-modal-item:hover .category-count,
        .category-modal-item.active .category-count {
            background: rgba(255,255,255,0.3);
        }

        /* Responsive */
        @media (min-width: 400px) {
            .search-bar {
                max-width: 160px;
            }
            
            .product-card {
                min-height: 300px;
            }
            
            .product-image-container {
                height: 130px;
            }
        }

        @media (min-width: 480px) {
            .container {
                padding: 0 12px;
            }
            
            .header-content {
                gap: 10px;
            }
            
            .search-bar {
                max-width: 180px;
            }
            
            .search-bar input {
                font-size: 0.75rem;
                padding: 5px 10px;
            }
            
            .theme-toggle, .language-btn {
                font-size: 0.7rem;
                padding: 4px 8px;
            }
            
            .logo {
                font-size: 1rem;
            }
            
            .products-grid {
                gap: 10px;
            }
            
            .product-card {
                min-height: 320px;
            }
            
            .product-image-container {
                height: 140px;
            }
        }

        @media (min-width: 768px) {
            .container {
                padding: 0 15px;
            }
            
            .products-grid {
                grid-template-columns: repeat(3, 1fr);
                gap: 12px;
            }
            
            .product-card {
                padding: 10px;
                min-height: 350px;
            }
            
            .product-image-container {
                height: 150px;
            }
            
            .product-title {
                font-size: 0.8rem;
                height: 34px;
            }
            
            .current-price {
                font-size: 0.9rem;
            }
            
            .product-code {
                padding: 6px 8px;
                font-size: 0.75rem;
            }
            
            .buy-btn {
                padding: 6px;
                font-size: 0.75rem;
            }
            
            .header-actions {
                gap: 8px;
            }
            
            .search-bar {
                max-width: 200px;
            }
            
            .theme-toggle, .language-btn {
                font-size: 0.75rem;
                padding: 5px 10px;
            }
        }

        @media (min-width: 1024px) {
            .products-grid {
                grid-template-columns: repeat(4, 1fr);
                gap: 15px;
            }
            
            .product-card {
                min-height: 380px;
            }
            
            .product-image-container {
                height: 160px;
            }
            
            .container {
                padding: 0 20px;
            }
            
            .header-actions {
                gap: 10px;
            }
            
            .search-bar {
                max-width: 250px;
            }
        }

        @media (min-width: 1200px) {
            .products-grid {
                grid-template-columns: repeat(5, 1fr);
                gap: 18px;
            }
            
            .product-card {
                min-height: 400px;
            }
            
            .product-image-container {
                height: 170px;
            }
        }

        /* Touch device improvements */
        @media (hover: none) {
            .product-card:hover {
                transform: none;
            }
        }
    </style>
</head>
<body>
    <!-- Toast Notification -->
    <div class="toast" id="toast">
        <i class="fas fa-check-circle"></i>
        <span id="toast-message">İndirim kodu kopyalandı!</span>
    </div>

    <!-- Copy Message -->
    <div id="copyMsg" class="copy-msg">Kupon kopyalandı ✅</div>

    <!-- Header -->
    <header>
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <i class="fas fa-bolt"></i>
                    <span data-translate="siteTitle">Budget Buddy</span>
                </div>
                <div class="header-actions">
                    <div class="search-bar">
                        <input type="text" id="search-input" placeholder="Ürün ara..." data-translate="searchPlaceholder">
                        <button id="search-btn"><i class="fas fa-search"></i></button>
                    </div>
                    <button class="theme-toggle" id="theme-toggle">
                        <i class="fas fa-moon"></i>
                        <span data-translate="darkMode">Koyu</span>
                    </button>
                    <div class="language-selector">
                        <button class="language-btn" id="language-btn">
                            <i class="fas fa-globe"></i>
                            <span id="current-language">TR</span>
                            <i class="fas fa-chevron-down"></i>
                        </button>
                        <div class="language-dropdown" id="language-dropdown">
                            <!-- Languages will be populated by JavaScript -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Hero Section -->
    <section class="hero">
        <div class="container">
            <h1 data-translate="heroTitle">En İyi AliExpress İndirimleri</h1>
            <p data-translate="heroSubtitle">Günlük indirim kodları ile en popüler ürünleri keşfedin!</p>
        </div>
    </section>

    <div class="container">
        <!-- Status Info -->
        <div class="status-info" id="status-info">
            <h3><i class="fas fa-sync-alt fa-spin"></i> <span data-translate="loadingProducts">Ürünler Yükleniyor</span>...</h3>
            <p data-translate="loadingDescription">Excel dosyasından ürün bilgileri alınıyor. Lütfen bekleyin.</p>
        </div>

        <!-- Main Content -->
        <div id="main-content" style="display: none;">
            <!-- Categories - Tüm Kategoriler, Favoriler ve Sırala butonları -->
            <div class="categories" id="categories">
                <button class="category-btn active" data-category="all" id="all-categories-btn">
                    <i class="fas fa-th-large"></i> <span data-translate="allCategories">Tüm Kategoriler</span> (<span id="all-categories-count">0</span>)
                </button>
                <button class="category-btn" data-filter="favorites" id="favorites-filter-btn">
                    <i class="fas fa-heart"></i> <span data-translate="filterFavorites">Favoriler</span> (<span id="favorites-count-badge">0</span>)
                </button>
                <select class="sort-select" id="sort-select">
                    <option value="default" data-translate="sortDefault">Sırala</option>
                    <option value="price-low" data-translate="sortPriceLow">Fiyat ↑</option>
                    <option value="price-high" data-translate="sortPriceHigh">Fiyat ↓</option>
                    <option value="discount" data-translate="sortDiscount">İndirim</option>
                    <option value="rating" data-translate="sortRating">Puan</option>
                </select>
            </div>

            <!-- Favorites Management -->
            <div class="favorites-management" id="favorites-management">
                <div id="favorites-count" data-translate="favoritesCount">
                    Toplam 0 favori ürün
                </div>
                <button class="clear-favorites-btn" id="clear-all-favorites" data-translate="clearAllFavorites">
                    Tüm Favorileri Temizle
                </button>
            </div>

            <!-- Products Grid -->
            <div id="products" class="products-grid"></div>

            <!-- Loading Indicator -->
            <div class="loading" id="loading-indicator">
                <div class="loading-spinner"></div>
                <p data-translate="loadingMore">Daha fazla ürün yükleniyor...</p>
            </div>

            <!-- End of Results -->
            <div class="end-of-results" id="end-of-results">
                <i class="fas fa-flag-checkered"></i>
                <h3 data-translate="endOfResultsTitle">Tüm ürünleri görüntülediniz!</h3>
                <p data-translate="endOfResultsDescription">Listelenen tüm ürünleri görüntülediniz. Daha fazla sonuç için farklı bir kategori veya filtre deneyebilirsiniz.</p>
            </div>

            <!-- No Favorites Message -->
            <div class="no-favorites" id="no-favorites">
                <i class="far fa-heart"></i>
                <h3 data-translate="noFavoritesTitle">Henüz favori ürününüz yok</h3>
                <p data-translate="noFavoritesDescription">Beğendiğiniz ürünlerin yanındaki kalp ikonuna tıklayarak favorilere ekleyebilirsiniz.</p>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3 data-translate="footerAbout">AliExpress İndirim</h3>
                    <p data-translate="footerDescription">En iyi AliExpress ürünlerini en uygun fiyatlarla bulabileceğiniz platform.</p>
                </div>
                <div class="footer-section">
                    <h3 data-translate="footerLinks">Hızlı Bağlantılar</h3>
                    <ul>
                        <li><a href="#" data-translate="footerHome">Ana Sayfa</a></li>
                        <li><a href="#" data-translate="footerPopular">Popüler</a></li>
                        <li><a href="#" data-translate="footerNew">Yeni</a></li>
                        <li><a href="#" data-translate="footerContact">İletişim</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h3 data-translate="footerHelp">Yardım</h3>
                    <ul>
                        <li><a href="#" data-translate="footerFAQ">SSS</a></li>
                        <li><a href="#" data-translate="footerShipping">Kargo</a></li>
                        <li><a href="#" data-translate="footerReturn">İade</a></li>
                        <li><a href="#" data-translate="footerPrivacy">Gizlilik</a></li>
                    </ul>
                </div>
            </div>
            <div class="copyright">
                &copy; 2023 AliExpress İndirim. <span data-translate="footerRights">Tüm hakları saklıdır.</span>
            </div>
        </div>
    </footer>

    <!-- Categories Modal -->
    <div class="modal-overlay" id="categories-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" data-translate="allCategoriesModal">Tüm Kategoriler</h3>
                <button class="modal-close" id="modal-close">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <ul class="categories-modal-list" id="categories-modal-list">
                    <!-- Kategoriler JavaScript ile eklenecek -->
                </ul>
            </div>
        </div>
    </div>

    <!-- Confirmation Modal -->
    <div class="confirmation-modal" id="confirmation-modal">
        <div class="confirmation-content">
            <div class="confirmation-header">
                <h3 class="confirmation-title" data-translate="confirmationTitle">Emin misiniz?</h3>
                <button class="confirmation-close" id="confirmation-close">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="confirmation-body">
                <p class="confirmation-message" data-translate="confirmationMessage">Tüm favori ürünlerinizi temizlemek istediğinizden emin misiniz? Bu işlem geri alınamaz.</p>
                <div class="confirmation-actions">
                    <button class="cancel-btn" id="cancel-clear" data-translate="cancelButton">Hayır</button>
                    <button class="confirm-btn" id="confirm-clear" data-translate="confirmButton">Evet</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Çeviriler - Tüm diller aktif
        const translations = {
            tr: {
                siteTitle: "Budget Buddy",
                searchPlaceholder: "Ara...",
                heroTitle: "En İyi İndirimler",
                heroSubtitle: "Günlük indirim kodları ile popüler ürünler!",
                loadingProducts: "Yükleniyor",
                loadingDescription: "Ürünler hazırlanıyor...",
                clearAllFavorites: "Tümünü Temizle",
                favoritesCount: "{count} favori",
                allCategories: "Tüm Kategoriler",
                allCategoriesModal: "Tüm Kategoriler",
                filterAll: "Tümü",
                filterFavorites: "Favoriler",
                sortDefault: "Sırala",
                sortPriceLow: "Fiyat ↑",
                sortPriceHigh: "Fiyat ↓",
                sortDiscount: "İndirim",
                sortRating: "Puan",
                noFavoritesTitle: "Favori yok",
                noFavoritesDescription: "Ürünleri favorilere ekleyin.",
                loadingMore: "Daha fazla ürün yükleniyor...",
                endOfResultsTitle: "Tüm ürünleri görüntülediniz!",
                endOfResultsDescription: "Listelenen tüm ürünleri görüntülediniz. Daha fazla sonuç için farklı bir kategori veya filtre deneyebilirsiniz.",
                footerAbout: "AliExpress",
                footerDescription: "En iyi ürünler uygun fiyatlarla.",
                footerLinks: "Bağlantılar",
                footerHome: "Ana Sayfa",
                footerPopular: "Popüler",
                footerNew: "Yeni",
                footerContact: "İletişim",
                footerHelp: "Yardım",
                footerFAQ: "SSS",
                footerShipping: "Kargo",
                footerReturn: "İade",
                footerPrivacy: "Gizlilik",
                footerRights: "Tüm hakları saklıdır.",
                codeCopied: "Kopyalandı:",
                addedToFavorites: "Favorilere eklendi",
                removedFromFavorites: "Favorilerden çıkarıldı",
                allFavoritesCleared: "Tüm favoriler temizlendi",
                shareText: "Bu ürünü inceleyin!",
                darkMode: "Koyu",
                lightMode: "Açık",
                noProductsFound: "Ürün bulunamadı.",
                discountCode: "Kod:",
                buyNow: "Satın Al",
                confirmationTitle: "Emin misiniz?",
                confirmationMessage: "Tüm favori ürünlerinizi temizlemek istediğinizden emin misiniz? Bu işlem geri alınamaz.",
                cancelButton: "Hayır",
                confirmButton: "Evet"
            },
            en: {
                siteTitle: "Budget Buddy",
                searchPlaceholder: "Search...",
                heroTitle: "Best Discounts",
                heroSubtitle: "Daily discount codes for popular products!",
                loadingProducts: "Loading",
                loadingDescription: "Products preparing...",
                clearAllFavorites: "Clear All",
                favoritesCount: "{count} favorites",
                allCategories: "All Categories",
                allCategoriesModal: "All Categories",
                filterAll: "All",
                filterFavorites: "Favorites",
                sortDefault: "Sort",
                sortPriceLow: "Price ↑",
                sortPriceHigh: "Price ↓",
                sortDiscount: "Discount",
                sortRating: "Rating",
                noFavoritesTitle: "No Favorites",
                noFavoritesDescription: "Add products to favorites.",
                loadingMore: "Loading more products...",
                endOfResultsTitle: "You've viewed all products!",
                endOfResultsDescription: "You've viewed all listed products. Try a different category or filter for more results.",
                footerAbout: "AliExpress",
                footerDescription: "Best products at affordable prices.",
                footerLinks: "Links",
                footerHome: "Home",
                footerPopular: "Popular",
                footerNew: "New",
                footerContact: "Contact",
                footerHelp: "Help",
                footerFAQ: "FAQ",
                footerShipping: "Shipping",
                footerReturn: "Return",
                footerPrivacy: "Privacy",
                footerRights: "All rights reserved.",
                codeCopied: "Copied:",
                addedToFavorites: "Added to favorites",
                removedFromFavorites: "Removed from favorites",
                allFavoritesCleared: "All favorites cleared",
                shareText: "Check this product!",
                darkMode: "Dark",
                lightMode: "Light",
                noProductsFound: "No products found.",
                discountCode: "Code:",
                buyNow: "Buy Now",
                confirmationTitle: "Are you sure?",
                confirmationMessage: "Are you sure you want to clear all your favorite products? This action cannot be undone.",
                cancelButton: "No",
                confirmButton: "Yes"
            },
            es: {
                siteTitle: "Budget Buddy",
                searchPlaceholder: "Buscar...",
                heroTitle: "Mejores Descuentos",
                heroSubtitle: "¡Códigos de descuento diarios!",
                loadingProducts: "Cargando",
                loadingDescription: "Productos preparándose...",
                clearAllFavorites: "Limpiar Todo",
                favoritesCount: "{count} favoritos",
                allCategories: "Todas las Categorías",
                allCategoriesModal: "Todas las Categorías",
                filterAll: "Todos",
                filterFavorites: "Favoritos",
                sortDefault: "Ordenar",
                sortPriceLow: "Precio ↑",
                sortPriceHigh: "Precio ↓",
                sortDiscount: "Descuento",
                sortRating: "Puntuación",
                noFavoritesTitle: "Sin Favoritos",
                noFavoritesDescription: "Agrega productos a favoritos.",
                loadingMore: "Cargando más productos...",
                endOfResultsTitle: "¡Has visto todos los productos!",
                endOfResultsDescription: "Has visto todos los productos listados. Prueba una categoría o filtro diferente para más resultados.",
                footerAbout: "AliExpress",
                footerDescription: "Mejores productos a precios asequibles.",
                footerLinks: "Enlaces",
                footerHome: "Inicio",
                footerPopular: "Popular",
                footerNew: "Nuevo",
                footerContact: "Contacto",
                footerHelp: "Ayuda",
                footerFAQ: "FAQ",
                footerShipping: "Envío",
                footerReturn: "Devolución",
                footerPrivacy: "Privacidad",
                footerRights: "Todos los derechos reservados.",
                codeCopied: "Copiado:",
                addedToFavorites: "Agregado a favoritos",
                removedFromFavorites: "Eliminado de favoritos",
                allFavoritesCleared: "Todos los favoritos eliminados",
                shareText: "¡Mira este producto!",
                darkMode: "Oscuro",
                lightMode: "Claro",
                noProductsFound: "No se encontraron productos.",
                discountCode: "Código:",
                buyNow: "Comprar",
                confirmationTitle: "¿Estás seguro?",
                confirmationMessage: "¿Estás seguro de que quieres eliminar todos tus productos favoritos? Esta acción no se puede deshacer.",
                cancelButton: "No",
                confirmButton: "Sí"
            },
            fr: {
                siteTitle: "Budget Buddy",
                searchPlaceholder: "Rechercher...",
                heroTitle: "Meilleures Promotions",
                heroSubtitle: "Codes de réduction quotidiens !",
                loadingProducts: "Chargement",
                loadingDescription: "Produits en préparation...",
                clearAllFavorites: "Tout Effacer",
                favoritesCount: "{count} favoris",
                allCategories: "Toutes les Catégories",
                allCategoriesModal: "Toutes les Catégories",
                filterAll: "Tous",
                filterFavorites: "Favoris",
                sortDefault: "Trier",
                sortPriceLow: "Prix ↑",
                sortPriceHigh: "Prix ↓",
                sortDiscount: "Réduction",
                sortRating: "Note",
                noFavoritesTitle: "Aucun Favori",
                noFavoritesDescription: "Ajoutez des produits aux favoris.",
                loadingMore: "Chargement de plus de produits...",
                endOfResultsTitle: "Vous avez vu tous les produits !",
                endOfResultsDescription: "Vous avez vu todos los productos listados. Essayez une catégorie ou un filtre différent pour plus de résultats.",
                footerAbout: "AliExpress",
                footerDescription: "Meilleurs produits à prix abordables.",
                footerLinks: "Liens",
                footerHome: "Accueil",
                footerPopular: "Populaire",
                footerNew: "Nouveau",
                footerContact: "Contact",
                footerHelp: "Aide",
                footerFAQ: "FAQ",
                footerShipping: "Livraison",
                footerReturn: "Retour",
                footerPrivacy: "Confidentialité",
                footerRights: "Tous droits réservés.",
                codeCopied: "Copié :",
                addedToFavorites: "Ajouté aux favoris",
                removedFromFavorites: "Retiré des favoris",
                allFavoritesCleared: "Tous les favoris effacés",
                shareText: "Découvrez ce produit !",
                darkMode: "Sombre",
                lightMode: "Clair",
                noProductsFound: "Aucun produit trouvé.",
                discountCode: "Code :",
                buyNow: "Acheter",
                confirmationTitle: "Êtes-vous sûr ?",
                confirmationMessage: "Êtes-vous sûr de vouloir supprimer tous vos produits favoris ? Cette action ne peut pas être annulée.",
                cancelButton: "Non",
                confirmButton: "Oui"
            },
            de: {
                siteTitle: "Budget Buddy",
                searchPlaceholder: "Suchen...",
                heroTitle: "Beste Rabatte",
                heroSubtitle: "Tägliche Rabattcodes für beliebte Produkte!",
                loadingProducts: "Lädt",
                loadingDescription: "Produkte werden vorbereitet...",
                clearAllFavorites: "Alle löschen",
                favoritesCount: "{count} Favoriten",
                allCategories: "Alle Kategorien",
                allCategoriesModal: "Alle Kategorien",
                filterAll: "Alle",
                filterFavorites: "Favoriten",
                sortDefault: "Sortieren",
                sortPriceLow: "Preis ↑",
                sortPriceHigh: "Preis ↓",
                sortDiscount: "Rabatt",
                sortRating: "Bewertung",
                noFavoritesTitle: "Keine Favoriten",
                noFavoritesDescription: "Produkte zu Favoriten hinzufügen.",
                loadingMore: "Lade mehr Produkte...",
                endOfResultsTitle: "Sie haben alle Produkte gesehen!",
                endOfResultsDescription: "Sie haben alle gelisteten Produkte gesehen. Versuchen Sie eine andere Kategorie ou filter für weitere Ergebnisse.",
                footerAbout: "AliExpress",
                footerDescription: "Beste Produkte zu erschwinglichen Preisen.",
                footerLinks: "Links",
                footerHome: "Startseite",
                footerPopular: "Beliebt",
                footerNew: "Neu",
                footerContact: "Kontakt",
                footerHelp: "Hilfe",
                footerFAQ: "FAQ",
                footerShipping: "Versand",
                footerReturn: "Rückgabe",
                footerPrivacy: "Datenschutz",
                footerRights: "Alle Rechte vorbehalten.",
                codeCopied: "Kopiert:",
                addedToFavorites: "Zu Favoriten hinzugefügt",
                removedFromFavorites: "Aus Favoriten entfernt",
                allFavoritesCleared: "Alle Favoriten gelöscht",
                shareText: "Schauen Sie sich dieses Produkt an!",
                darkMode: "Dunkel",
                lightMode: "Hell",
                noProductsFound: "Keine Produkte gefunden.",
                discountCode: "Code:",
                buyNow: "Jetzt kaufen",
                confirmationTitle: "Sind Sie sicher?",
                confirmationMessage: "Sind Sie sicher, dass Sie alle Ihre Lieblingsprodukte löschen möchten? Diese Aktion kann nicht rückgängig gemacht werden.",
                cancelButton: "Nein",
                confirmButton: "Ja"
            },
            ru: {
                siteTitle: "Budget Buddy",
                searchPlaceholder: "Поиск...",
                heroTitle: "Лучшие скидки",
                heroSubtitle: "Ежедневные коды скидок на популярные товары!",
                loadingProducts: "Загрузка",
                loadingDescription: "Товары подготавливаются...",
                clearAllFavorites: "Очистить все",
                favoritesCount: "{count} избранных",
                allCategories: "Все категории",
                allCategoriesModal: "Все категории",
                filterAll: "Все",
                filterFavorites: "Избранное",
                sortDefault: "Сортировать",
                sortPriceLow: "Цена ↑",
                sortPriceHigh: "Цена ↓",
                sortDiscount: "Скидка",
                sortRating: "Рейтинг",
                noFavoritesTitle: "Нет избранных",
                noFavoritesDescription: "Добавьте товары в избранное.",
                loadingMore: "Загрузка больше товаров...",
                endOfResultsTitle: "Вы просмотрели все товары!",
                endOfResultsDescription: "Вы просмотрели все товары в списке. Попробуйте другую категорию или фильтр для получения дополнительных результатов.",
                footerAbout: "AliExpress",
                footerDescription: "Лучшие товары по доступным ценам.",
                footerLinks: "Ссылки",
                footerHome: "Главная",
                footerPopular: "Популярные",
                footerNew: "Новинки",
                footerContact: "Контакты",
                footerHelp: "Помощь",
                footerFAQ: "FAQ",
                footerShipping: "Доставка",
                footerReturn: "Возврат",
                footerPrivacy: "Конфиденциальность",
                footerRights: "Все права защищены.",
                codeCopied: "Скопировано:",
                addedToFavorites: "Добавлено в избранное",
                removedFromFavorites: "Удалено из избранного",
                allFavoritesCleared: "Все избранные очищены",
                shareText: "Посмотрите этот товар!",
                darkMode: "Темный",
                lightMode: "Светлый",
                noProductsFound: "Товары не найдены.",
                discountCode: "Код:",
                buyNow: "Купить",
                confirmationTitle: "Вы уверены?",
                confirmationMessage: "Вы уверены, что хотите очистить все ваши избранные товары? Это действие нельзя отменить.",
                cancelButton: "Нет",
                confirmButton: "Да"
            },
            ar: {
                siteTitle: "Budget Buddy",
                searchPlaceholder: "بحث...",
                heroTitle: "أفضل الخصومات",
                heroSubtitle: "رموز الخصم اليومية للمنتجات الشعبية!",
                loadingProducts: "جار التحميل",
                loadingDescription: "يتم تحضير المنتجات...",
                clearAllFavorites: "مسح الكل",
                favoritesCount: "{count} مفضل",
                allCategories: "جميع الفئات",
                allCategoriesModal: "جميع الفئات",
                filterAll: "الكل",
                filterFavorites: "المفضلة",
                sortDefault: "ترتيب",
                sortPriceLow: "السعر ↑",
                sortPriceHigh: "السعر ↓",
                sortDiscount: "خصم",
                sortRating: "تقييم",
                noFavoritesTitle: "لا توجد مفضلات",
                noFavoritesDescription: "أضف المنتجات إلى المفضلة.",
                loadingMore: "جاري تحميل المزيد من المنتجات...",
                endOfResultsTitle: "لقد شاهدت جميع المنتجات!",
                endOfResultsDescription: "لقد شاهدت جميع المنتجات المدرجة. جرب فئة أو مرشحًا مختلفًا لمزيد من النتائج.",
                footerAbout: "AliExpress",
                footerDescription: "أفضل المنتجات بأسعار معقولة.",
                footerLinks: "روابط",
                footerHome: "الرئيسية",
                footerPopular: "الأكثر شهرة",
                footerNew: "الجديد",
                footerContact: "اتصل بنا",
                footerHelp: "المساعدة",
                footerFAQ: "الأسئلة الشائعة",
                footerShipping: "الشحن",
                footerReturn: "الإرجاع",
                footerPrivacy: "الخصوصية",
                footerRights: "جميع الحقوق محفوظة.",
                codeCopied: "تم النسخ:",
                addedToFavorites: "تمت الإضافة إلى المفضلة",
                removedFromFavorites: "تمت الإزالة من المفضلة",
                allFavoritesCleared: "تم مسح جميع المفضلة",
                shareText: "تحقق من هذا المنتج!",
                darkMode: "داكن",
                lightMode: "فاتح",
                noProductsFound: "لم يتم العثور على منتجات.",
                discountCode: "كود:",
                buyNow: "اشتر الآن",
                confirmationTitle: "هل أنت متأكد؟",
                confirmationMessage: "هل أنت متأكد أنك تريد مسح جميع منتجاتك المفضلة؟ لا يمكن التراجع عن هذا الإجراء.",
                cancelButton: "لا",
                confirmButton: "نعم"
            },
            zh: {
                siteTitle: "Budget Buddy",
                searchPlaceholder: "搜索...",
                heroTitle: "最佳折扣",
                heroSubtitle: "热门产品每日折扣码！",
                loadingProducts: "加载中",
                loadingDescription: "产品准备中...",
                clearAllFavorites: "全部清除",
                favoritesCount: "{count} 收藏",
                allCategories: "所有类别",
                allCategoriesModal: "所有类别",
                filterAll: "全部",
                filterFavorites: "收藏夹",
                sortDefault: "排序",
                sortPriceLow: "价格 ↑",
                sortPriceHigh: "价格 ↓",
                sortDiscount: "折扣",
                sortRating: "评分",
                noFavoritesTitle: "无收藏",
                noFavoritesDescription: "将产品添加到收藏夹。",
                loadingMore: "加载更多产品...",
                endOfResultsTitle: "您已查看所有产品！",
                endOfResultsDescription: "您已查看所有列出的产品。尝试不同的类别或过滤器以获得更多结果。",
                footerAbout: "AliExpress",
                footerDescription: "实惠价格的最佳产品。",
                footerLinks: "链接",
                footerHome: "首页",
                footerPopular: "热门",
                footerNew: "新品",
                footerContact: "联系我们",
                footerHelp: "帮助",
                footerFAQ: "常见问题",
                footerShipping: "运输",
                footerReturn: "退货",
                footerPrivacy: "隐私",
                footerRights: "保留所有权利。",
                codeCopied: "已复制：",
                addedToFavorites: "已添加到收藏夹",
                removedFromFavorites: "已从收藏夹移除",
                allFavoritesCleared: "所有收藏已清除",
                shareText: "查看此产品！",
                darkMode: "深色",
                lightMode: "浅色",
                noProductsFound: "未找到产品。",
                discountCode: "代码：",
                buyNow: "立即购买",
                confirmationTitle: "您确定吗？",
                confirmationMessage: "您确定要清除所有收藏产品吗？此操作无法撤消。",
                cancelButton: "否",
                confirmButton: "是"
            },
            ja: {
                siteTitle: "Budget Buddy",
                searchPlaceholder: "検索...",
                heroTitle: "ベストディスカウント",
                heroSubtitle: "人気商品の毎日割引コード！",
                loadingProducts: "読み込み中",
                loadingDescription: "商品を準備中...",
                clearAllFavorites: "すべてクリア",
                favoritesCount: "{count} お気に入り",
                allCategories: "すべてのカテゴリー",
                allCategoriesModal: "すべてのカテゴリー",
                filterAll: "すべて",
                filterFavorites: "お気に入り",
                sortDefault: "並び替え",
                sortPriceLow: "価格 ↑",
                sortPriceHigh: "価格 ↓",
                sortDiscount: "割引",
                sortRating: "評価",
                noFavoritesTitle: "お気に入りなし",
                noFavoritesDescription: "商品をお気に入りに追加します。",
                loadingMore: "さらに商品を読み込み中...",
                endOfResultsTitle: "すべての商品を表示しました！",
                endOfResultsDescription: "リストされたすべての商品を表示しました。より多くの結果を得るために、別のカテゴリーやフィルターをお試しください。",
                footerAbout: "AliExpress",
                footerDescription: "お手頃価格のベスト商品。",
                footerLinks: "リンク",
                footerHome: "ホーム",
                footerPopular: "人気",
                footerNew: "新着",
                footerContact: "お問い合わせ",
                footerHelp: "ヘルプ",
                footerFAQ: "よくある質問",
                footerShipping: "配送",
                footerReturn: "返品",
                footerPrivacy: "プライバシー",
                footerRights: "全著作権所有。",
                codeCopied: "コピー済み：",
                addedToFavorites: "お気に入りに追加されました",
                removedFromFavorites: "お気に入りから削除されました",
                allFavoritesCleared: "すべてのお気に入りがクリアされました",
                shareText: "この商品をチェック！",
                darkMode: "ダーク",
                lightMode: "ライト",
                noProductsFound: "商品が見つかりません。",
                discountCode: "コード：",
                buyNow: "購入する",
                confirmationTitle: "よろしいですか？",
                confirmationMessage: "すべてのお気に入り商品をクリアしてもよろしいですか？この操作は元に戻せません。",
                cancelButton: "いいえ",
                confirmButton: "はい"
            }
        };

        // Global değişkenler
        let allProducts = [];
        let displayedProducts = 0;
        const productsPerPage = 50;
        let currentFilter = 'all';
        let currentCategory = 'all';
        let currentSort = 'default';
        let isLoading = false;
        let hasMoreProducts = true;
        let favorites = JSON.parse(localStorage.getItem('favorites')) || [];
        let currentLanguage = localStorage.getItem('language') || 'tr';
        let currentTheme = localStorage.getItem('theme') || 'dark';
        
        // Sonsuz scroll değişkenleri
        let filteredProducts = [];
        let currentDisplayedCount = 0;

        // DOM Elements
        const productsGrid = document.getElementById('products');
        const statusInfo = document.getElementById('status-info');
        const mainContent = document.getElementById('main-content');
        const loadingIndicator = document.getElementById('loading-indicator');
        const categoriesContainer = document.getElementById('categories');
        const favoritesManagement = document.getElementById('favorites-management');
        const noFavorites = document.getElementById('no-favorites');
        const endOfResults = document.getElementById('end-of-results');
        const toast = document.getElementById('toast');
        const toastMessage = document.getElementById('toast-message');
        const copyMsg = document.getElementById('copyMsg');
        
        // Modal Elements
        const categoriesModal = document.getElementById('categories-modal');
        const categoriesModalList = document.getElementById('categories-modal-list');
        const modalClose = document.getElementById('modal-close');
        const allCategoriesBtn = document.getElementById('all-categories-btn');
        const favoritesFilterBtn = document.getElementById('favorites-filter-btn');

        // Confirmation Modal Elements
        const confirmationModal = document.getElementById('confirmation-modal');
        const confirmationClose = document.getElementById('confirmation-close');
        const cancelClearBtn = document.getElementById('cancel-clear');
        const confirmClearBtn = document.getElementById('confirm-clear');

        // Excel URL
        const EXCEL_FILE_URL = './data3.xls';

        // AliExpress Kategorileri ve Anahtar Kelimeleri
        const categoryKeywords = {
            'Automotive & Motorcycle': [
                'car', 'auto', 'automotive', 'motorcycle', 'bike', 'vehicle', 'tire', 'wheel', 'engine', 
                'brake', 'exhaust', 'headlight', 'taillight', 'mirror', 'seat', 'helmet', 'gloves', 
                'jacket', 'oil', 'filter', 'battery', 'charger', 'tool', 'accessory', 'parts', 'gps',
                'dash cam', 'car camera', 'car audio', 'speaker', 'subwoofer', 'amplifier', 'alarm',
                'lock', 'cover', 'mat', 'cleaner', 'polish', 'wax', 'detailing', 'maintenance'
            ],
            'Beauty & Health': [
                'makeup', 'cosmetic', 'skincare', 'beauty', 'health', 'facial', 'cream', 'lotion', 
                'serum', 'moisturizer', 'cleanser', 'toner', 'mask', 'makeup brush', 'palette', 
                'lipstick', 'mascara', 'eyeshadow', 'foundation', 'concealer', 'blush', 'highlighter',
                'perfume', 'fragrance', 'deodorant', 'shampoo', 'conditioner', 'hair care', 'styling',
                'hair dryer', 'straightener', 'curler', 'trimmer', 'shaver', 'epilator', 'massager',
                'scale', 'thermometer', 'blood pressure', 'fitness', 'vitamin', 'supplement'
            ],
            'Phones & Telecommunications': [
                'smartphone', 'phone', 'mobile', 'iphone', 'samsung', 'huawei', 'xiaomi', 'oppo', 
                'vivo', 'oneplus', 'android', 'ios', '5g', '4g', 'case', 'cover', 'screen protector',
                'charger', 'cable', 'adapter', 'power bank', 'headphone', 'earphone', 'earbud', 
                'bluetooth', 'wireless', 'smartwatch', 'watch', 'tablet', 'ipad', 'accessory',
                'sim card', 'router', 'modem', 'antenna', 'repeater', 'telecommunication'
            ],
            'Home Improvement & Lighting': [
                'home improvement', 'lighting', 'lamp', 'light', 'led', 'bulb', 'fixture', 'ceiling',
                'wall', 'floor', 'desk', 'outdoor', 'garden', 'solar', 'motion', 'sensor', 'switch',
                'outlet', 'extension', 'cord', 'tool', 'drill', 'saw', 'hammer', 'screwdriver',
                'wrench', 'pliers', 'tape', 'measure', 'level', 'paint', 'brush', 'roller', 'toolbox',
                'ladder', 'safety', 'workwear', 'storage', 'shelf', 'rack', 'organization'
            ],
            'Jewelry, Watches & Accessories': [
                'jewelry', 'watch', 'accessory', 'necklace', 'bracelet', 'ring', 'earring', 'pendant',
                'chain', 'bangle', 'anklet', 'brooch', 'cufflink', 'tie clip', 'money clip', 'keychain',
                'sunglasses', 'glasses', 'case', 'luxury', 'fashion', 'diamond', 'gold', 'silver',
                'platinum', 'pearl', 'crystal', 'gemstone', 'birthstone', 'engraving', 'personalized',
                'smart watch', 'fitness tracker', 'activity band', 'watch band', 'strap'
            ],
            'Womens Clothing': [
                'women', 'clothing', 'dress', 'skirt', 'blouse', 'shirt', 'top', 't-shirt', 'sweater',
                'cardigan', 'jacket', 'coat', 'hoodie', 'sweatshirt', 'pants', 'jeans', 'leggings',
                'shorts', 'jumpsuit', 'romper', 'lingerie', 'bra', 'panties', 'shapewear', 'swimwear',
                'bikini', 'swimsuit', 'cover up', 'activewear', 'yoga', 'fitness', 'workout', 'socks',
                'tights', 'stockings', 'maternity', 'plus size', 'petite', 'fashion', 'trendy'
            ],
            'Electronics': [
                'electronics', 'electronic', 'gadget', 'device', 'tech', 'technology', 'smart', 'home',
                'audio', 'video', 'tv', 'television', 'monitor', 'display', 'projector', 'speaker',
                'soundbar', 'headphone', 'earphone', 'microphone', 'camera', 'lens', 'drone', 'action',
                'gopro', 'tripod', 'gimbal', 'stabilizer', 'computer', 'laptop', 'tablet', 'printer',
                'scanner', 'keyboard', 'mouse', 'webcam', 'router', 'nas', 'storage', 'hard drive'
            ],
            'Mens Clothing': [
                'men', 'clothing', 'shirt', 't-shirt', 'polo', 'button down', 'dress shirt', 'casual',
                'sweater', 'hoodie', 'sweatshirt', 'jacket', 'coat', 'blazer', 'suit', 'pants', 'jeans',
                'chinos', 'shorts', 'swimwear', 'trunks', 'underwear', 'boxers', 'briefs', 'socks',
                'tie', 'belt', 'wallet', 'accessory', 'workwear', 'uniform', 'activewear', 'fitness',
                'outdoor', 'hiking', 'fishing', 'hunting', 'formal', 'business', 'casual', 'streetwear'
            ],
            'Home & Garden': [
                'home', 'garden', 'furniture', 'decor', 'decoration', 'accessory', 'kitchen', 'bath',
                'bedroom', 'living', 'dining', 'outdoor', 'patio', 'lawn', 'plant', 'flower', 'pot',
                'vase', 'candle', 'diffuser', 'wall art', 'picture', 'frame', 'clock', 'mirror',
                'rug', 'carpet', 'mat', 'curtain', 'blind', 'shade', 'pillow', 'cushion', 'blanket',
                'throw', 'bedding', 'sheet', 'duvet', 'comforter', 'quilt', 'towel', 'bath mat'
            ],
            'Toys & Games': [
                'toy', 'game', 'kids', 'children', 'baby', 'educational', 'learning', 'development',
                'puzzle', 'building', 'block', 'lego', 'brick', 'doll', 'action figure', 'vehicle',
                'car', 'truck', 'plane', 'train', 'robot', 'rc', 'remote control', 'drone', 'helicopter',
                'board game', 'card game', 'puzzle game', 'video game', 'console', 'controller',
                'vr', 'virtual reality', 'outdoor', 'playground', 'swing', 'slide', 'trampoline'
            ],
            'Luggage, Bags & Shoes': [
                'luggage', 'bag', 'shoe', 'travel', 'suitcase', 'backpack', 'handbag', 'purse',
                'wallet', 'briefcase', 'messenger', 'tote', 'duffel', 'garment', 'cosmetic', 'laptop',
                'sneaker', 'athletic', 'running', 'walking', 'hiking', 'boot', 'dress', 'casual',
                'sandals', 'flip flop', 'slipper', 'heel', 'pump', 'flat', 'loafer', 'oxford',
                'accessory', 'organizer', 'packing', 'travel gear', 'luggage tag', 'lock'
            ],
            'Furniture': [
                'furniture', 'furnishing', 'table', 'desk', 'chair', 'sofa', 'couch', 'loveseat',
                'sectional', 'recliner', 'ottoman', 'bench', 'stool', 'bed', 'mattress', 'headboard',
                'dresser', 'chest', 'wardrobe', 'armoire', 'cabinet', 'shelf', 'bookcase', 'entertainment',
                'tv stand', 'console', 'coffee', 'end', 'nightstand', 'dining', 'kitchen', 'bar',
                'counter', 'island', 'patio', 'garden', 'outdoor', 'office', 'ergonomic', 'gaming'
            ],
            'Computer, Office & Education': [
                'computer', 'office', 'education', 'laptop', 'desktop', 'monitor', 'keyboard', 'mouse',
                'printer', 'scanner', 'copier', 'fax', 'projector', 'screen', 'whiteboard', 'desk',
                'chair', 'filing', 'cabinet', 'shelf', 'organizer', 'supply', 'pen', 'pencil', 'marker',
                'highlighter', 'notebook', 'binder', 'folder', 'calculator', 'ruler', 'stapler',
                'staple', 'tape', 'glue', 'scissors', 'educational', 'learning', 'teaching', 'science'
            ],
            'Hair Extensions & Wigs': [
                'hair', 'extension', 'wig', 'toupee', 'weave', 'clip-in', 'tape-in', 'fusion',
                'micro', 'strand', 'bundle', 'closure', 'frontal', 'lace', 'synthetic', 'human',
                'remy', 'virgin', 'straight', 'wavy', 'curly', 'kinky', 'color', 'dye', 'highlight',
                'ombre', 'balayage', 'styling', 'care', 'shampoo', 'conditioner', 'treatment',
                'brush', 'comb', 'dryer', 'iron', 'curler', 'accessory', 'cap', 'stand'
            ],
            'Sports & Entertainment': [
                'sports', 'entertainment', 'fitness', 'exercise', 'workout', 'gym', 'yoga', 'pilates',
                'running', 'walking', 'hiking', 'camping', 'fishing', 'hunting', 'cycling', 'biking',
                'swimming', 'diving', 'surfing', 'skiing', 'snowboarding', 'skateboarding', 'roller',
                'team', 'soccer', 'basketball', 'football', 'baseball', 'tennis', 'golf', 'badminton',
                'music', 'instrument', 'guitar', 'piano', 'keyboard', 'drum', 'violin', 'microphone',
                'karaoke', 'dj', 'lighting', 'effect', 'party', 'event', 'game', 'console'
            ],
            'Baby & Maternity': [
                'baby', 'maternity', 'infant', 'toddler', 'child', 'newborn', 'pregnancy', 'mother',
                'nursery', 'crib', 'bassinet', 'bed', 'mattress', 'changing', 'table', 'dresser',
                'storage', 'organizer', 'stroller', 'pram', 'carrier', 'sling', 'car seat', 'high chair',
                'booster', 'bath', 'tub', 'toy', 'educational', 'development', 'clothing', 'onesie',
                'romper', 'sleepwear', 'blanket', 'swaddle', 'feeding', 'bottle', 'pacifier', 'health'
            ],
            'Plus Sized Clothing': [
                'plus size', 'plus sized', 'curvy', 'big', 'tall', 'women', 'men', 'clothing',
                'dress', 'top', 'blouse', 'shirt', 't-shirt', 'sweater', 'cardigan', 'jacket',
                'coat', 'hoodie', 'sweatshirt', 'pants', 'jeans', 'leggings', 'shorts', 'skirt',
                'jumpsuit', 'romper', 'lingerie', 'bra', 'panties', 'shapewear', 'swimwear',
                'activewear', 'fitness', 'workout', 'fashion', 'trendy', 'stylish', 'comfort'
            ],
            'Pet Supplies': [
                'pet', 'supply', 'dog', 'cat', 'puppy', 'kitten', 'food', 'treat', 'snack', 'bowl',
                'feeder', 'waterer', 'fountain', 'bed', 'mat', 'crate', 'cage', 'carrier', 'house',
                'shelter', 'toy', 'chew', 'bone', 'ball', 'frisbee', 'leash', 'collar', 'harness',
                'clothing', 'costume', 'grooming', 'brush', 'comb', 'shampoo', 'conditioner', 'health',
                'vitamin', 'supplement', 'medicine', 'first aid', 'cleaning', 'litter', 'box', 'training'
            ]
        };

        // Event Listeners
        document.getElementById('search-btn').addEventListener('click', performSearch);
        document.getElementById('search-input').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') performSearch();
        });

        document.getElementById('sort-select').addEventListener('change', handleSortChange);
        document.getElementById('theme-toggle').addEventListener('click', toggleTheme);
        document.getElementById('language-btn').addEventListener('click', toggleLanguageDropdown);
        document.getElementById('clear-all-favorites').addEventListener('click', showConfirmationModal);
        
        // Sonsuz scroll için event listener
        window.addEventListener('scroll', handleScroll);
        
        // Modal Event Listeners
        allCategoriesBtn.addEventListener('click', openCategoriesModal);
        modalClose.addEventListener('click', closeCategoriesModal);
        categoriesModal.addEventListener('click', function(e) {
            if (e.target === categoriesModal) {
                closeCategoriesModal();
            }
        });
        
        // Confirmation Modal Event Listeners
        confirmationClose.addEventListener('click', closeConfirmationModal);
        cancelClearBtn.addEventListener('click', closeConfirmationModal);
        confirmClearBtn.addEventListener('click', clearAllFavorites);
        confirmationModal.addEventListener('click', function(e) {
            if (e.target === confirmationModal) {
                closeConfirmationModal();
            }
        });
        
        // ESC tuşu ile modal kapatma
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                if (categoriesModal.classList.contains('show')) {
                    closeCategoriesModal();
                }
                if (confirmationModal.classList.contains('show')) {
                    closeConfirmationModal();
                }
            }
        });

        // Sayfa dışına tıklanınca dropdown'ı kapat
        document.addEventListener('click', (e) => {
            if (!e.target.closest('.language-selector')) {
                document.getElementById('language-dropdown').classList.remove('show');
            }
        });

        // Tema değiştirme
        function toggleTheme() {
            currentTheme = currentTheme === 'light' ? 'dark' : 'light';
            document.documentElement.setAttribute('data-theme', currentTheme);
            localStorage.setItem('theme', currentTheme);
            updateThemeButton();
        }

        function updateThemeButton() {
            const icon = document.querySelector('#theme-toggle i');
            const text = document.querySelector('#theme-toggle span');
            if (currentTheme === 'dark') {
                icon.className = 'fas fa-sun';
                text.setAttribute('data-translate', 'lightMode');
            } else {
                icon.className = 'fas fa-moon';
                text.setAttribute('data-translate', 'darkMode');
            }
            updatePageLanguage();
        }

        // Dil değiştirme
        function changeLanguage(lang) {
            currentLanguage = lang;
            localStorage.setItem('language', lang);
            document.getElementById('current-language').textContent = lang.toUpperCase();
            updatePageLanguage();
            toggleLanguageDropdown();
            
            // Ürünleri yeniden render et
            if (allProducts.length > 0) {
                filterAndDisplayProducts();
            }
        }

        function toggleLanguageDropdown() {
            document.getElementById('language-dropdown').classList.toggle('show');
        }

        function createLanguageOptions() {
            const languages = [
                { code: 'tr', name: 'Türkçe', flag: '🇹🇷' },
                { code: 'en', name: 'English', flag: '🇺🇸' },
                { code: 'es', name: 'Español', flag: '🇪🇸' },
                { code: 'fr', name: 'Français', flag: '🇫🇷' },
                { code: 'de', name: 'Deutsch', flag: '🇩🇪' },
                { code: 'ru', name: 'Русский', flag: '🇷🇺' },
                { code: 'ar', name: 'العربية', flag: '🇸🇦' },
                { code: 'zh', name: '中文', flag: '🇨🇳' },
                { code: 'ja', name: '日本語', flag: '🇯🇵' }
            ];

            const dropdown = document.getElementById('language-dropdown');
            dropdown.innerHTML = languages.map(lang => `
                <div class="language-option" onclick="changeLanguage('${lang.code}')">
                    ${lang.flag} ${lang.name}
                </div>
            `).join('');
        }

        // Sayfa dilini güncelle
        function updatePageLanguage() {
            document.querySelectorAll('[data-translate]').forEach(element => {
                const key = element.getAttribute('data-translate');
                if (translations[currentLanguage] && translations[currentLanguage][key]) {
                    let translatedText = translations[currentLanguage][key];
                    
                    // Özel durumlar için değişkenleri değiştir
                    if (key === 'favoritesCount') {
                        translatedText = translatedText.replace('{count}', favorites.length);
                    }
                    
                    if (element.tagName === 'INPUT') {
                        element.placeholder = translatedText;
                    } else if (element.tagName === 'OPTION') {
                        element.textContent = translatedText;
                    } else {
                        element.textContent = translatedText;
                    }
                }
            });
            updateFavoritesCount();
        }

        // Ürün başlığını çevir
        function translateProductTitle(title, targetLang) {
            if (targetLang === 'en') return title;
            
            let translatedTitle = title;
            const titleLower = title.toLowerCase();
            
            // Her dil için basit çeviri
            const translationMap = {
                tr: {},
                es: {},
                fr: {},
                de: {},
                ru: {},
                ar: {},
                zh: {},
                ja: {}
            };
            
            return translatedTitle;
        }

        // Toast bildirimi
        function showToast(message) {
            toastMessage.textContent = message;
            toast.classList.add('show');
            setTimeout(() => toast.classList.remove('show'), 3000);
        }

        // Kupon kopyalama mesajı
        function showCopyMsg() {
            copyMsg.style.display = "block";
            setTimeout(() => copyMsg.style.display = "none", 1300);
        }

        // Onay modalını göster
        function showConfirmationModal() {
            if (favorites.length === 0) {
                showToast(currentLanguage === 'tr' ? 'Favori ürün bulunmuyor!' : 'No favorite products found!');
                return;
            }
            confirmationModal.classList.add('show');
            document.body.style.overflow = 'hidden';
        }

        // Onay modalını kapat
        function closeConfirmationModal() {
            confirmationModal.classList.remove('show');
            document.body.style.overflow = '';
        }

        // Kategori tahmini yap
        function predictCategory(productTitle) {
            const title = productTitle.toLowerCase();
            
            for (const [category, keywords] of Object.entries(categoryKeywords)) {
                for (const keyword of keywords) {
                    if (title.includes(keyword.toLowerCase())) {
                        return category;
                    }
                }
            }
            
            return 'Diğer';
        }

        // Modal açma fonksiyonu
        function openCategoriesModal() {
            // Kategori listesini oluştur
            renderCategoriesModal();
            
            // Modalı göster
            categoriesModal.classList.add('show');
            document.body.style.overflow = 'hidden'; // Sayfa kaydırmayı engelle
        }

        // Modal kapatma fonksiyonu
        function closeCategoriesModal() {
            categoriesModal.classList.remove('show');
            document.body.style.overflow = ''; // Sayfa kaydırmayı geri aç
        }

        // Modal için kategori listesini oluştur
        function renderCategoriesModal() {
            if (!allProducts || allProducts.length === 0) return;
            
            // Kategorileri topla ve sayılarını hesapla
            const categoryCounts = {};
            allProducts.forEach(product => {
                const category = product.category || 'Diğer';
                categoryCounts[category] = (categoryCounts[category] || 0) + 1;
            });
            
            // Tüm kategorileri sırala (sabit sırada)
            const allCategoryList = [
                'all',
                'Automotive & Motorcycle',
                'Beauty & Health', 
                'Phones & Telecommunications',
                'Home Improvement & Lighting',
                'Jewelry, Watches & Accessories',
                'Womens Clothing',
                'Electronics',
                'Mens Clothing',
                'Home & Garden',
                'Toys & Games',
                'Luggage, Bags & Shoes',
                'Furniture',
                'Computer, Office & Education',
                'Hair Extensions & Wigs',
                'Sports & Entertainment',
                'Baby & Maternity',
                'Plus Sized Clothing',
                'Pet Supplies',
                'Diğer'
            ];
            
            // Modal içeriğini oluştur
            categoriesModalList.innerHTML = allCategoryList.map(category => {
                let count, displayName;
                
                if (category === 'all') {
                    count = allProducts.length;
                    displayName = translations[currentLanguage].allCategories || 'Tüm Kategoriler';
                } else {
                    count = categoryCounts[category] || 0;
                    displayName = category;
                }
                
                const isActive = currentCategory === category;
                
                return `
                    <li class="category-modal-item ${isActive ? 'active' : ''}" 
                        data-category="${category}" 
                        onclick="selectCategoryFromModal('${category}')">
                        <span class="category-name">
                            <i class="fas ${category === 'all' ? 'fa-th-large' : 'fa-tag'}"></i>
                            ${displayName}
                        </span>
                        <span class="category-count">${count}</span>
                    </li>
                `;
            }).join('');
        }

        // Modal'dan kategori seçme - DÜZELTİLDİ
        function selectCategoryFromModal(category) {
            // Kategoriyi seç
            currentCategory = category;
            currentDisplayedCount = 0;
            
            // Tüm Kategoriler butonunu güncelle
            updateAllCategoriesButton();
            
            // Modal'ı kapat
            closeCategoriesModal();
            
            // Favori filtresini kapat
            currentFilter = 'all';
            favoritesManagement.classList.remove('show');
            
            // Tüm Kategoriler butonunu aktif yap
            document.querySelectorAll('.category-btn').forEach(btn => btn.classList.remove('active'));
            allCategoriesBtn.classList.add('active');
            
            // Ürünleri filtrele ve göster
            filterAndDisplayProducts();
        }

        // Tüm Kategoriler butonunu güncelle
        function updateAllCategoriesButton() {
            const count = currentCategory === 'all' 
                ? allProducts.length 
                : allProducts.filter(p => p.category === currentCategory).length;
            
            allCategoriesBtn.innerHTML = `
                <i class="fas fa-th-large"></i> 
                <span data-translate="allCategories">${currentCategory === 'all' ? translations[currentLanguage].allCategories : currentCategory}</span> 
                (${count})
            `;
            
            // Çeviriyi tekrar uygula
            const span = allCategoriesBtn.querySelector('span[data-translate]');
            if (span && translations[currentLanguage]) {
                const key = span.getAttribute('data-translate');
                if (translations[currentLanguage][key]) {
                    span.textContent = currentCategory === 'all' 
                        ? translations[currentLanguage][key] 
                        : currentCategory;
                }
            }
        }

        // Kategori sayısını al
        function getCategoryCount(category) {
            if (category === 'all') return allProducts.length;
            return allProducts.filter(p => p.category === category).length;
        }

        // Excel yükleme
        async function loadExcelFile() {
            try {
                console.log("Excel yükleniyor...");
                
                // Test ürünleri oluştur - Her kategori için örnek ürünler
                const testProducts = [];
                const categories = Object.keys(categoryKeywords);
                
                // Her kategori için 8-10 örnek ürün oluştur
                categories.forEach((category, categoryIndex) => {
                    const categoryKeywordsList = categoryKeywords[category];
                    
                    for (let i = 1; i <= 10; i++) {
                        const productIndex = (categoryIndex * 10) + i;
                        const randomKeyword = categoryKeywordsList[Math.floor(Math.random() * categoryKeywordsList.length)];
                        const discount = Math.floor(Math.random() * 50) + 10;
                        const originalPrice = Math.floor(Math.random() * 1000) + 100;
                        const discountPrice = Math.floor(originalPrice * (100 - discount) / 100);
                        
                        testProducts.push({
                            id: productIndex.toString(),
                            title: `${randomKeyword} ${productIndex} - Premium Quality ${category} Product with Special Features`,
                            image: `https://via.placeholder.com/300x200/${Math.floor(Math.random()*16777215).toString(16)}/FFFFFF?text=${category.replace(/\s+/g, '+')}`,
                            originalPrice: `₺${originalPrice}`,
                            discountPrice: `₺${discountPrice}`,
                            discount: `%${discount}`,
                            code: `CODE${productIndex}`,
                            link: '#',
                            category: category,
                            rating: (Math.random() * 10 + 85).toFixed(0),
                            sales: Math.floor(Math.random() * 2000) + 100
                        });
                    }
                });

                // Gerçek Excel dosyasını yükle
                try {
                    const response = await fetch(EXCEL_FILE_URL);
                    if (response.ok) {
                        const arrayBuffer = await response.arrayBuffer();
                        const data = new Uint8Array(arrayBuffer);
                        const workbook = XLSX.read(data, { type: 'array' });
                        const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
                        const jsonData = XLSX.utils.sheet_to_json(firstSheet);
                        
                        if (jsonData.length > 0) {
                            allProducts = jsonData.map(item => {
                                const originalTitle = item['Product Desc'] || item.title || 'Ürün';
                                const product = {
                                    id: item.ProductId || Math.random().toString(36).substr(2, 9),
                                    title: originalTitle,
                                    originalTitle: originalTitle,
                                    image: item['Image Url'] || item.image || 'https://via.placeholder.com/300x200/666/FFFFFF?text=Resim+Yok',
                                    originalPrice: item['Origin Price'] || item.originalPrice || '₺0',
                                    discountPrice: item['Discount Price'] || item.discountPrice || '₺0', 
                                    discount: item.Discount || item.discount || '%0',
                                    code: item['Code Name'] || item.code || '',
                                    link: item['Promotion Url'] || item.link || '#',
                                    category: item.Category || item.category || '',
                                    rating: item['Positive Feedback'] || item.rating || '0',
                                    sales: item.Sales180Day || item.sales || '0'
                                };
                                
                                if (!product.category) {
                                    product.category = predictCategory(product.title);
                                }
                                
                                return product;
                            });
                            console.log("Excel'den", allProducts.length, "ürün yüklendi");
                        } else {
                            throw new Error('Excel dosyası boş');
                        }
                    } else {
                        throw new Error('Excel dosyası bulunamadı');
                    }
                } catch (error) {
                    console.log("Excel yüklenemedi, test verileri kullanılıyor:", error.message);
                    allProducts = testProducts.map(product => ({
                        ...product,
                        originalTitle: product.title
                    }));
                }

                processProducts();
                
            } catch (error) {
                console.error("Hata:", error);
                statusInfo.innerHTML = `<h3><i class="fas fa-exclamation-triangle"></i> Hata</h3><p>${error.message}</p>`;
            }
        }

        // Ürünleri işle
        function processProducts() {
            // Tüm Kategoriler, Favoriler ve Sırala butonlarını göster
            categoriesContainer.innerHTML = `
                <button class="category-btn active" data-category="all" id="all-categories-btn">
                    <i class="fas fa-th-large"></i> <span data-translate="allCategories">Tüm Kategoriler</span> (<span id="all-categories-count">${allProducts.length}</span>)
                </button>
                <button class="category-btn" data-filter="favorites" id="favorites-filter-btn">
                    <i class="fas fa-heart"></i> <span data-translate="filterFavorites">Favoriler</span> (<span id="favorites-count-badge">${favorites.length}</span>)
                </button>
                <select class="sort-select" id="sort-select">
                    <option value="default" data-translate="sortDefault">Sırala</option>
                    <option value="price-low" data-translate="sortPriceLow">Fiyat ↑</option>
                    <option value="price-high" data-translate="sortPriceHigh">Fiyat ↓</option>
                    <option value="discount" data-translate="sortDiscount">İndirim</option>
                    <option value="rating" data-translate="sortRating">Puan</option>
                </select>
            `;

            // Tüm Kategoriler butonuna event listener ekle
            document.getElementById('all-categories-btn').addEventListener('click', openCategoriesModal);

            // Favoriler butonuna event listener ekle
            document.getElementById('favorites-filter-btn').addEventListener('click', function() {
                document.querySelectorAll('.category-btn').forEach(btn => btn.classList.remove('active'));
                this.classList.add('active');
                currentFilter = 'favorites';
                currentDisplayedCount = 0;
                favoritesManagement.classList.add('show');
                filterAndDisplayProducts();
            });

            statusInfo.style.display = 'none';
            mainContent.style.display = 'block';
            
            filterAndDisplayProducts();
        }

        // Filtrele ve göster
        function filterAndDisplayProducts() {
            filteredProducts = [...allProducts];
            
            // Kategori filtresi - DÜZELTİLDİ
            if (currentCategory !== 'all') {
                filteredProducts = filteredProducts.filter(p => p.category === currentCategory);
            }
            
            // Ana filtreler
            switch(currentFilter) {
                case 'favorites':
                    filteredProducts = filteredProducts.filter(p => favorites.includes(p.id));
                    break;
            }
            
            // Sıralama
            applySorting(filteredProducts);
            
            // İlk 50 ürünü göster
            currentDisplayedCount = 0;
            loadMoreProducts();
        }

        // Sıralama
        function handleSortChange() {
            currentSort = document.getElementById('sort-select').value;
            currentDisplayedCount = 0;
            filterAndDisplayProducts();
        }

        function applySorting(products) {
            switch(currentSort) {
                case 'price-low':
                    products.sort((a, b) => extractPrice(a.discountPrice) - extractPrice(b.discountPrice));
                    break;
                case 'price-high':
                    products.sort((a, b) => extractPrice(b.discountPrice) - extractPrice(a.discountPrice));
                    break;
                case 'discount':
                    products.sort((a, b) => extractDiscount(b.discount) - extractDiscount(a.discount));
                    break;
                case 'rating':
                    products.sort((a, b) => parseFloat(b.rating) - parseFloat(a.rating));
                    break;
            }
            return products;
        }

        function extractPrice(priceStr) {
            const match = priceStr.match(/[\d,]+/);
            return match ? parseFloat(match[0].replace(',', '')) : 0;
        }

        function extractDiscount(discountStr) {
            const match = discountStr.match(/\d+/);
            return match ? parseInt(match[0]) : 0;
        }

        // Daha fazla ürün yükle
        function loadMoreProducts() {
            if (isLoading) return;
            
            const startIndex = currentDisplayedCount;
            const endIndex = Math.min(currentDisplayedCount + productsPerPage, filteredProducts.length);
            
            if (startIndex >= filteredProducts.length) {
                // Tüm ürünler yüklendi
                endOfResults.style.display = 'block';
                loadingIndicator.style.display = 'none';
                return;
            }
            
            isLoading = true;
            loadingIndicator.style.display = 'block';
            endOfResults.style.display = 'none';
            
            // Simüle edilmiş yükleme gecikmesi
            setTimeout(() => {
                const productsToShow = filteredProducts.slice(startIndex, endIndex);
                
                if (currentDisplayedCount === 0) {
                    // İlk yükleme, tüm ürünleri temizle
                    productsGrid.innerHTML = '';
                }
                
                renderProducts(productsToShow);
                
                currentDisplayedCount = endIndex;
                isLoading = false;
                loadingIndicator.style.display = 'none';
                
                // Tüm ürünler yüklendi mi kontrol et
                if (currentDisplayedCount >= filteredProducts.length) {
                    endOfResults.style.display = 'block';
                }
            }, 500);
        }

        // Scroll işleyicisi
        function handleScroll() {
            if (isLoading) return;
            
            const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
            const windowHeight = window.innerHeight;
            const documentHeight = document.documentElement.scrollHeight;
            
            // Sayfanın sonuna yaklaşıldığında daha fazla ürün yükle
            if (scrollTop + windowHeight >= documentHeight - 500) {
                loadMoreProducts();
            }
        }

        // Ürünleri render et
        function renderProducts(products) {
            if (products.length === 0 && currentDisplayedCount === 0) {
                if (currentFilter === 'favorites') {
                    noFavorites.style.display = 'block';
                    productsGrid.style.display = 'none';
                } else {
                    productsGrid.innerHTML = `<p style="grid-column: 1/-1; text-align: center; padding: 40px;">${translations[currentLanguage].noProductsFound}</p>`;
                }
                loadingIndicator.style.display = 'none';
                endOfResults.style.display = 'none';
                return;
            }

            noFavorites.style.display = 'none';
            productsGrid.style.display = 'grid';

            products.forEach(product => {
                const isFavorite = favorites.includes(product.id);
                
                // Ürün başlığını çevir
                const displayTitle = currentLanguage === 'en' 
                    ? product.title 
                    : translateProductTitle(product.originalTitle || product.title, currentLanguage);
                
                const productCard = document.createElement('div');
                productCard.className = 'product-card';
                productCard.innerHTML = `
                    <div class="product-image-container" onclick="window.open('${product.link}', '_blank')">
                        <div class="product-badge">${product.discount}</div>
                        <div class="category-badge">${product.category}</div>
                        ${currentFilter === 'favorites' ? `
                        <button class="remove-favorite-btn" onclick="removeFavorite('${product.id}', event)">
                            <i class="fas fa-times"></i>
                        </button>
                        ` : ''}
                        <img src="${product.image}" alt="${displayTitle}" class="product-image" onerror="this.src='https://via.placeholder.com/300x200/666/FFFFFF?text=Resim+Yok'">
                    </div>
                    <div class="product-info">
                        <h3 class="product-title" onclick="toggleTitle(this)">${displayTitle}</h3>
                        <div class="product-price">
                            <span class="current-price">${product.discountPrice}</span>
                            <span class="original-price">${product.originalPrice}</span>
                            <span class="discount">${product.discount}</span>
                        </div>
                        ${product.code ? `
                        <div class="product-code">
                            <span class="code-label">${translations[currentLanguage].discountCode}</span>
                            <span class="code-value" onclick="copyCode('${product.code}', event)">${product.code}</span>
                        </div>
                        ` : ''}
                        <div class="product-actions">
                            <a href="${product.link}" target="_blank" class="buy-btn">
                                <i class="fas fa-shopping-cart"></i> ${translations[currentLanguage].buyNow}
                            </a>
                            <button class="wishlist-btn ${isFavorite ? 'active' : ''}" onclick="toggleFavorite('${product.id}')">
                                <i class="${isFavorite ? 'fas' : 'far'} fa-heart"></i>
                            </button>
                            <button class="share-btn" onclick="shareProduct(${JSON.stringify(product).replace(/"/g, '&quot;')}, event)">
                                <i class="fas fa-share-alt"></i>
                            </button>
                        </div>
                    </div>
                `;
                productsGrid.appendChild(productCard);
            });
        }

        // Ürün başlığını genişlet/daralt
        function toggleTitle(element) {
            element.classList.toggle('expanded');
        }

        // Favori işlemleri
        function toggleFavorite(productId) {
            const index = favorites.indexOf(productId);
            if (index === -1) {
                favorites.push(productId);
                showToast(translations[currentLanguage].addedToFavorites);
            } else {
                favorites.splice(index, 1);
                showToast(translations[currentLanguage].removedFromFavorites);
            }
            localStorage.setItem('favorites', JSON.stringify(favorites));
            updateFavoritesUI();
            
            if (currentFilter === 'favorites') {
                currentDisplayedCount = 0;
                filterAndDisplayProducts();
            }
        }

        function removeFavorite(productId, event) {
            if (event) event.stopPropagation();
            const index = favorites.indexOf(productId);
            if (index !== -1) {
                favorites.splice(index, 1);
                localStorage.setItem('favorites', JSON.stringify(favorites));
                showToast(translations[currentLanguage].removedFromFavorites);
                updateFavoritesUI();
                
                if (currentFilter === 'favorites') {
                    currentDisplayedCount = 0;
                    filterAndDisplayProducts();
                }
            }
        }

        function clearAllFavorites() {
            if (favorites.length > 0) {
                favorites = [];
                localStorage.setItem('favorites', JSON.stringify(favorites));
                showToast(translations[currentLanguage].allFavoritesCleared);
                updateFavoritesUI();
                closeConfirmationModal();
                
                if (currentFilter === 'favorites') {
                    currentDisplayedCount = 0;
                    filterAndDisplayProducts();
                }
            } else {
                closeConfirmationModal();
                showToast(currentLanguage === 'tr' ? 'Favori ürün bulunmuyor!' : 'No favorite products found!');
            }
        }

        function updateFavoritesUI() {
            updateFavoritesCount();
            
            // Favori sayısını badge'de güncelle
            const favoritesBadge = document.getElementById('favorites-count-badge');
            if (favoritesBadge) {
                favoritesBadge.textContent = favorites.length;
            }
            
            const favoriteButtons = document.querySelectorAll('.wishlist-btn');
            favoriteButtons.forEach(btn => {
                const productCard = btn.closest('.product-card');
                if (productCard) {
                    const productId = getProductIdFromCard(productCard);
                    if (favorites.includes(productId)) {
                        btn.classList.add('active');
                        btn.innerHTML = '<i class="fas fa-heart"></i>';
                    } else {
                        btn.classList.remove('active');
                        btn.innerHTML = '<i class="far fa-heart"></i>';
                    }
                }
            });
        }

        function getProductIdFromCard(card) {
            const wishlistBtn = card.querySelector('.wishlist-btn');
            const onclickAttr = wishlistBtn.getAttribute('onclick');
            const match = onclickAttr.match(/toggleFavorite\('([^']+)'\)/);
            return match ? match[1] : null;
        }

        function updateFavoritesCount() {
            const count = favorites.length;
            const favoritesCountElement = document.getElementById('favorites-count');
            if (translations[currentLanguage]) {
                favoritesCountElement.textContent = 
                    translations[currentLanguage].favoritesCount.replace('{count}', count);
            }
        }

        // Diğer fonksiyonlar
        function performSearch() {
            const term = document.getElementById('search-input').value.toLowerCase().trim();
            if (!term) {
                currentDisplayedCount = 0;
                filterAndDisplayProducts();
                return;
            }
            
            const filtered = allProducts.filter(p => {
                const displayTitle = currentLanguage === 'en' 
                    ? p.title 
                    : translateProductTitle(p.originalTitle || p.title, currentLanguage);
                
                return displayTitle.toLowerCase().includes(term) || 
                       (p.category && p.category.toLowerCase().includes(term));
            });
            
            filteredProducts = filtered;
            currentDisplayedCount = 0;
            loadMoreProducts();
        }

        function copyCode(code, event) {
            if (event) event.stopPropagation();
            navigator.clipboard.writeText(code).then(() => {
                showCopyMsg();
            }).catch(err => {
                showToast(currentLanguage === 'tr' ? 'Kopyalama başarısız!' : 'Copy failed!');
            });
        }

        function shareProduct(product, event) {
            if (event) event.stopPropagation();
            const shareText = translations[currentLanguage].shareText;
            const shareUrl = product.link;
            const discountCode = product.code ? `\n${translations[currentLanguage].discountCode} ${product.code}` : '';
            
            // Çevrilmiş başlık
            const displayTitle = currentLanguage === 'en' 
                ? product.title 
                : translateProductTitle(product.originalTitle || product.title, currentLanguage);
            
            if (navigator.share) {
                navigator.share({
                    title: displayTitle,
                    text: `${shareText}${discountCode}`,
                    url: shareUrl
                });
            } else {
                navigator.clipboard.writeText(`${displayTitle} - ${shareUrl}${discountCode}`);
                showToast(currentLanguage === 'tr' ? 'Ürün bilgileri kopyalandı!' : 'Product information copied!');
            }
        }

        // Sayfa yüklendiğinde
        window.addEventListener('DOMContentLoaded', () => {
            console.log("Sayfa yüklendi");
            
            // Temayı yükle
            const savedTheme = localStorage.getItem('theme') || 'dark';
            document.documentElement.setAttribute('data-theme', savedTheme);
            currentTheme = savedTheme;
            updateThemeButton();
            
            // Dili yükle
            const savedLanguage = localStorage.getItem('language') || 'tr';
            currentLanguage = savedLanguage;
            document.getElementById('current-language').textContent = savedLanguage.toUpperCase();
            
            createLanguageOptions();
            updatePageLanguage();
            loadExcelFile();
        });

        // Global fonksiyonlar
        window.changeLanguage = changeLanguage;
        window.toggleFavorite = toggleFavorite;
        window.removeFavorite = removeFavorite;
        window.copyCode = copyCode;
        window.shareProduct = shareProduct;
        window.toggleTitle = toggleTitle;
        window.openCategoriesModal = openCategoriesModal;
        window.closeCategoriesModal = closeCategoriesModal;
        window.selectCategoryFromModal = selectCategoryFromModal;
        window.showConfirmationModal = showConfirmationModal;
        window.closeConfirmationModal = closeConfirmationModal;
    </script>
</body>
</html>
